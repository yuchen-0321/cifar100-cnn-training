# CIFAR-100 CNN è¨“ç·´ç³»çµ±

[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/yuchen-0321/cifar100-cnn-training/blob/main/CIFAR_100_CNN_Training.ipynb)

## è¨ˆç®—æ™ºæ…§æœŸæœ«å°ˆæ¡ˆ

![Python](https://img.shields.io/badge/python-3.8+-blue.svg)
![PyTorch](https://img.shields.io/badge/pytorch-2.0+-ee4c2c.svg)
![License](https://img.shields.io/badge/license-MIT-green.svg)
![Accuracy](https://img.shields.io/badge/accuracy-78.38%25-brightgreen.svg)

**å­¸ç”Ÿ**ï¼šææ³“æ–Œ
**å­¸è™Ÿ**ï¼šC111110141
**ä»»èª²æ•™æˆ**ï¼šæ›¾å»ºèª 
**èª²ç¨‹**ï¼šè¨ˆç®—æ™ºæ…§

---

## å°ˆæ¡ˆæˆæœ

ä¸€å€‹å°ˆç‚º CIFAR-100 åˆ†é¡ä»»å‹™è¨­è¨ˆçš„CNN è¨“ç·´ç³»çµ±ï¼Œé”åˆ° **78.23% é©—è­‰æº–ç¢ºç‡**å’Œ **94.86% Top-5 æº–ç¢ºç‡**ã€‚

## æ•ˆèƒ½äº®é»

- **æ¸¬è©¦æº–ç¢ºç‡**: 78.25% (Top-1), 94.85% (Top-5)
- **è¨“ç·´æ™‚é–“**: 150.2 åˆ†é˜ï¼ˆTesla T4 GPUï¼‰
- **æ¨¡å‹å¤§å°**: 42.24 MBï¼ˆ11M åƒæ•¸ï¼‰
- **æ¨è«–é€Ÿåº¦**: 2300+ å¼µåœ–ç‰‡/ç§’ï¼ˆTesla T4ï¼‰
- **GPU è¨˜æ†¶é«”å³°å€¼**: 3.54 GB

## è¨“ç·´çµæœ

### æœ€çµ‚æŒ‡æ¨™
| æŒ‡æ¨™ | æ•¸å€¼ |
|------|------|
| **æœ€ä½³é©—è­‰æº–ç¢ºç‡** | 78.23%ï¼ˆç¬¬ 150 epochï¼‰ |
| **æœ€çµ‚æ¸¬è©¦æº–ç¢ºç‡ï¼ˆTop-1ï¼‰** | 78.25% |
| **æœ€çµ‚æ¸¬è©¦æº–ç¢ºç‡ï¼ˆTop-5ï¼‰** | 94.85% |
| **å¹³å‡é¡åˆ¥æº–ç¢ºç‡** | 78.25% |
| **é¡åˆ¥æº–ç¢ºç‡æ¨™æº–å·®** | 10.56% |
| **æœ€ä½é¡åˆ¥æº–ç¢ºç‡** | 53.00% |
| **æœ€é«˜é¡åˆ¥æº–ç¢ºç‡** | 94.00% |

## å¿«é€Ÿé–‹å§‹

### Google Colab ç’°å¢ƒ

```python
# è¤‡è£½å„²å­˜åº«
!git clone https://github.com/yourusername/cifar100-cnn-training.git
%cd cifar100-cnn-training

# ä½¿ç”¨é è¨­è¨­å®šåŸ·è¡Œè¨“ç·´
!python train.py
```

### æœ¬åœ°ç’°å¢ƒ

```bash
# è¤‡è£½å„²å­˜åº«
git clone https://github.com/yourusername/cifar100-cnn-training.git
cd cifar100-cnn-training

# å®‰è£ä¾è³´å¥—ä»¶
pip install -r requirements.txt

# åŸ·è¡Œè¨“ç·´
python train.py --epochs 150 --batch-size 256 --lr 0.1
```

## ğŸ’¡ æ ¸å¿ƒåŠŸèƒ½

### ç³»çµ±æ¶æ§‹
- **æ¨¡çµ„åŒ–è¨­è¨ˆ**ï¼šæ¸…æ™°çš„é—œæ³¨é»åˆ†é›¢ï¼ŒåŒ…å«è³‡æ–™è¼‰å…¥ã€æ¨¡å‹æ¶æ§‹ã€è¨“ç·´é‚è¼¯å’Œç›£æ§æ¨¡çµ„
- **ç”Ÿç”¢å°±ç·’**ï¼šå®Œæ•´çš„éŒ¯èª¤è™•ç†ã€è³‡æºç®¡ç†å’Œè‡ªå‹•æ¢å¾©æ©Ÿåˆ¶
- **è¨˜æ†¶é«”æ•ˆç‡**ï¼šæ··åˆç²¾åº¦è¨“ç·´ã€æ¢¯åº¦ç´¯ç©å’Œå‹•æ…‹æ‰¹æ¬¡å¤§å°èª¿æ•´

### è¨“ç·´æœ€ä½³åŒ–
- **æ··åˆç²¾åº¦è¨“ç·´**ï¼š2-3 å€é€Ÿåº¦æå‡ï¼Œç²¾åº¦æå¤±æœ€å°
- **å­¸ç¿’ç‡èª¿åº¦**ï¼šé¤˜å¼¦é€€ç«é…åˆæš–èº«ï¼Œç¢ºä¿ç©©å®šæ”¶æ–‚
- **é€²éšè³‡æ–™å¢å¼·**ï¼šä¸‰ç´šå¢å¼·ç­–ç•¥ï¼ˆè¼•åº¦/ä¸­åº¦/å¼·åº¦ï¼‰
- **æ¨™ç±¤å¹³æ»‘**ï¼šé˜²æ­¢éåº¦è‡ªä¿¡é æ¸¬ï¼Œæ”¹å–„æ³›åŒ–èƒ½åŠ›
- **æ—©åœæ©Ÿåˆ¶**ï¼šè‡ªå‹•çµ‚æ­¢è¨“ç·´ä»¥é˜²æ­¢éæ“¬åˆ

### æ¨¡å‹æ¶æ§‹
- **ResNet å•Ÿç™¼è¨­è¨ˆ**ï¼šé«˜æ•ˆçš„æ®˜å·®å¡Šé…åˆæ‰¹æ¬¡æ­£è¦åŒ–
- **æ¼¸é€²å¼é€šé“æ“´å±•**ï¼š64 â†’ 128 â†’ 256 â†’ 512 é€šé“
- **å…¨åŸŸå¹³å‡æ± åŒ–**ï¼šæ¸›å°‘åƒæ•¸åŒæ™‚ç¶­æŒæ•ˆèƒ½
- **Dropout æ­£è¦åŒ–**ï¼šå¯é…ç½®çš„ dropout é˜²æ­¢éæ“¬åˆ

## å°ˆæ¡ˆçµæ§‹

```
cifar100-cnn-training/
â”œâ”€â”€ train.py                 # ä¸»è¨“ç·´è…³æœ¬
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ resnet.py           # æ¨¡å‹æ¶æ§‹
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ dataloader.py       # è³‡æ–™ç®¡ç·šå’Œå¢å¼·
â”œâ”€â”€ trainers/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ trainer.py          # è¨“ç·´å”èª¿å™¨
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ metrics.py          # æŒ‡æ¨™è¿½è¹¤å’Œè¦–è¦ºåŒ–
â”‚   â”œâ”€â”€ monitor.py          # æ•ˆèƒ½ç›£æ§
â”‚   â””â”€â”€ config.py           # é…ç½®ç®¡ç†
â”œâ”€â”€ configs/
â”‚   â”œâ”€â”€ default.yaml        # é è¨­é…ç½®
â”‚   â””â”€â”€ experiments/        # å¯¦é©—é…ç½®
â”œâ”€â”€ checkpoints/            # æ¨¡å‹æª¢æŸ¥é»ï¼ˆè‡ªå‹•å»ºç«‹ï¼‰
â”œâ”€â”€ logs/                   # è¨“ç·´æ—¥èªŒï¼ˆè‡ªå‹•å»ºç«‹ï¼‰
â”œâ”€â”€ requirements.txt        # Python ä¾è³´
â””â”€â”€ README.md              # æœ¬æ–‡ä»¶
```

## âš™ï¸ è¨“ç·´é…ç½®

### é è¨­è¨­å®š

```python
@dataclass
class TrainingConfig:
    # æ¨¡å‹åƒæ•¸
    num_classes: int = 100
    dropout_rate: float = 0.3
    
    # è¨“ç·´åƒæ•¸
    epochs: int = 150
    batch_size: int = 256
    learning_rate: float = 0.1
    momentum: float = 0.9
    weight_decay: float = 5e-4
    
    # æœ€ä½³åŒ–
    mixed_precision: bool = True
    gradient_clip: float = 1.0
    label_smoothing: float = 0.1
    
    # èª¿åº¦å™¨
    lr_scheduler: str = 'cosine'
    warmup_epochs: int = 5
    
    # è³‡æ–™å¢å¼·
    augmentation_strength: str = 'moderate'
```

### è‡ªè¨‚é…ç½®

```python
from train import train_cifar100

# è‡ªè¨‚è¨“ç·´
model, metrics, results = train_cifar100(
    epochs=150,
    batch_size=256,
    learning_rate=0.1,
    mixed_precision=True,
    augmentation='moderate'
)
```

## è¨“ç·´æ›²ç·š

è¨“ç·´éç¨‹å‘ˆç¾ä¸‰å€‹æ˜é¡¯éšæ®µï¼š

1. **å¿«é€Ÿåˆå§‹å­¸ç¿’**ï¼ˆEpoch 1-30ï¼‰ï¼šå¾éš¨æ©ŸçŒœæ¸¬å¿«é€Ÿæå‡
2. **ç©©å®šæ”¹é€²**ï¼ˆEpoch 30-100ï¼‰ï¼šæŒçºŒä½†è¼ƒæ…¢çš„é€²æ­¥
3. **ç²¾ç´°èª¿æ•´**ï¼ˆEpoch 100-150ï¼‰ï¼šå¾®èª¿è‡³æœ€ä½³æ•ˆèƒ½

### é—œéµé‡Œç¨‹ç¢‘
- Epoch 10: 39.71% é©—è­‰æº–ç¢ºç‡
- Epoch 30: 59.55% é©—è­‰æº–ç¢ºç‡
- Epoch 50: 64.59% é©—è­‰æº–ç¢ºç‡
- Epoch 100: 78.40% é©—è­‰æº–ç¢ºç‡
- Epoch 150: 78.23% é©—è­‰æº–ç¢ºç‡ï¼ˆæœ€ä½³ï¼‰

## ğŸ”§ ç³»çµ±éœ€æ±‚

### ç¡¬é«”
- **GPU**ï¼šå…·æœ‰ 4GB+ VRAM çš„ NVIDIA GPUï¼ˆåœ¨ Tesla T4 ä¸Šæ¸¬è©¦ï¼‰
- **RAM**ï¼šæœ€å°‘ 8GB
- **å„²å­˜ç©ºé–“**ï¼š2GB ç”¨æ–¼è³‡æ–™é›†å’Œæª¢æŸ¥é»

### è»Ÿé«”
- Python 3.8+
- PyTorch 2.0+
- CUDA 11.8+ï¼ˆç”¨æ–¼ GPU åŠ é€Ÿï¼‰

## ğŸ“¦ ä¾è³´å¥—ä»¶

```txt
torch>=2.0.0
torchvision>=0.15.0
numpy>=1.21.0
matplotlib>=3.5.0
tqdm>=4.65.0
```

## ä½¿ç”¨ç¯„ä¾‹

### åŸºæœ¬è¨“ç·´

```python
from cifar100_pipeline import CIFAR100Pipeline

# åˆå§‹åŒ–ç®¡ç·š
pipeline = CIFAR100Pipeline()

# åŸ·è¡Œè¨“ç·´
model, metrics, results = pipeline.run()
```

### è¼‰å…¥é è¨“ç·´æ¨¡å‹

```python
import torch
from models.resnet import CIFAR100CNN
from utils.config import TrainingConfig

# è¼‰å…¥æª¢æŸ¥é»
checkpoint = torch.load('checkpoints/cifar100_final_model.pth')

# åˆå§‹åŒ–æ¨¡å‹
config = TrainingConfig()
model = CIFAR100CNN(config)
model.load_state_dict(checkpoint['model_state_dict'])
model.eval()

# æ¨¡å‹å·²æº–å‚™å¥½é€²è¡Œæ¨è«–
print(f"æ¸¬è©¦æº–ç¢ºç‡: {checkpoint['test_results']['test_acc']:.2f}%")
```

### æ¨è«–ç¯„ä¾‹

```python
import torch
from torchvision import transforms
from PIL import Image

# æº–å‚™åœ–ç‰‡
transform = transforms.Compose([
    transforms.Resize((32, 32)),
    transforms.ToTensor(),
    transforms.Normalize((0.5071, 0.4867, 0.4408), 
                        (0.2675, 0.2565, 0.2761))
])

# è¼‰å…¥ä¸¦é è™•ç†åœ–ç‰‡
image = Image.open('path/to/image.jpg')
input_tensor = transform(image).unsqueeze(0)

# æ¨è«–
with torch.no_grad():
    output = model(input_tensor)
    probabilities = torch.nn.functional.softmax(output, dim=1)
    top5_prob, top5_idx = torch.topk(probabilities, 5)
```

## å¯¦é©—è¿½è¹¤

### è¨“ç·´æ—¥èªŒ

ç³»çµ±è‡ªå‹•è¿½è¹¤ï¼š
- æå¤±æ›²ç·šï¼ˆè¨“ç·´å’Œé©—è­‰ï¼‰
- æº–ç¢ºç‡æŒ‡æ¨™ï¼ˆTop-1 å’Œ Top-5ï¼‰
- å­¸ç¿’ç‡èª¿åº¦
- æ¯é¡åˆ¥æº–ç¢ºç‡çµ±è¨ˆ
- GPU è¨˜æ†¶é«”ä½¿ç”¨
- æ¨è«–ååé‡

### æª¢æŸ¥é»

æ¯ 5 å€‹ epoch è‡ªå‹•å„²å­˜æª¢æŸ¥é»ï¼ŒåŒ…å«ï¼š
- æ¨¡å‹æ¬Šé‡
- å„ªåŒ–å™¨ç‹€æ…‹
- å­¸ç¿’ç‡èª¿åº¦å™¨ç‹€æ…‹
- è¨“ç·´é…ç½®
- æ•ˆèƒ½æŒ‡æ¨™

## æ•ˆèƒ½åŸºæº–

### æ¨è«–æ•ˆèƒ½ï¼ˆTesla T4ï¼‰

| æ‰¹æ¬¡å¤§å° | ååé‡ï¼ˆimg/sï¼‰ | è¨˜æ†¶é«”ï¼ˆGBï¼‰ |
|---------|----------------|-------------|
| 32 | 2,162.7 | 0.05 |
| 64 | 2,260.9 | 0.05 |
| 128 | 2,308.2 | 0.05 |
| 256 | 2,305.8 | 0.05 |

### èˆ‡å…¶ä»–æ–¹æ³•æ¯”è¼ƒ

| æ–¹æ³• | Top-1 æº–ç¢ºç‡ | Top-5 æº–ç¢ºç‡ | åƒæ•¸é‡ |
|-----|-------------|-------------|--------|
| **æˆ‘å€‘çš„æ–¹æ³•** | **78.25%** | **94.85%** | 11M |
| ResNet-18 | 75.61% | 93.45% | 11M |
| VGG-16 | 71.59% | 90.49% | 138M |
| DenseNet-121 | 79.04% | 94.84% | 8M |

## æŠ€è¡“æ´å¯Ÿ

### é—œéµè¨­è¨ˆæ±ºç­–

1. **æ®˜å·®é€£æ¥**ï¼šè§£æ±ºæ¢¯åº¦æ¶ˆå¤±ï¼Œå¯¦ç¾æ›´æ·±çš„ç¶²è·¯
2. **å…¨åŸŸå¹³å‡æ± åŒ–**ï¼šç›¸æ¯”å…¨é€£æ¥å±¤æ¸›å°‘ 90% åƒæ•¸
3. **æ··åˆç²¾åº¦è¨“ç·´**ï¼š2-3 å€é€Ÿåº¦æå‡ï¼Œæº–ç¢ºç‡æå¤± <0.1%
4. **é¤˜å¼¦é€€ç«**ï¼šå¹³æ»‘çš„å­¸ç¿’ç‡è¡°æ¸›é˜²æ­¢çªç„¶çš„æ•ˆèƒ½ä¸‹é™
5. **æ¨™ç±¤å¹³æ»‘ï¼ˆ0.1ï¼‰**ï¼šæ”¹å–„æ³›åŒ–èƒ½åŠ› 1-2% æº–ç¢ºç‡

### æœ€ä½³åŒ–ç­–ç•¥

- **æ¢¯åº¦è£å‰ª**ï¼šé˜²æ­¢æ¢¯åº¦çˆ†ç‚¸
- **æ‰¹æ¬¡æ­£è¦åŒ–**ï¼šåŠ é€Ÿæ”¶æ–‚
- **Dropoutï¼ˆ0.3ï¼‰**ï¼šæ­£è¦åŒ–è€Œä¸éåº¦æ¸›å°‘å®¹é‡
- **è³‡æ–™å¢å¼·**ï¼šå¹³è¡¡çš„å¢å¼·é˜²æ­¢éæ“¬åˆ

## è¨“ç·´æŠ€å·§

### ç²å¾—æœ€ä½³çµæœ

1. **ä½¿ç”¨ 150 epochs**ï¼š100 epochs å¾Œä»æœ‰æ”¹é€²ç©ºé–“
2. **æ‰¹æ¬¡å¤§å° 256**ï¼šåœ¨é€Ÿåº¦å’Œæ³›åŒ–ä¹‹é–“å–å¾—å¹³è¡¡
3. **ä¸­åº¦å¢å¼·**ï¼šé¿å…éåº¦å¢å¼·é€ æˆçš„å™ªéŸ³
4. **ç›£æ§é©—è­‰æå¤±**ï¼šæ—©åœé˜²æ­¢éæ“¬åˆ

### å¸¸è¦‹å•é¡Œè§£æ±º

**éæ“¬åˆå•é¡Œ**ï¼š
- å¢åŠ  dropout rateï¼ˆ0.3 â†’ 0.5ï¼‰
- ä½¿ç”¨å¼·åº¦è³‡æ–™å¢å¼·
- å•Ÿç”¨æ›´å¤šæ­£è¦åŒ–æŠ€è¡“

**æ”¶æ–‚ç·©æ…¢**ï¼š
- æª¢æŸ¥å­¸ç¿’ç‡æ˜¯å¦éå°
- ç¢ºèªæ‰¹æ¬¡æ­£è¦åŒ–æ­£å¸¸é‹ä½œ
- è€ƒæ…®ä½¿ç”¨æ›´å¤§çš„æ‰¹æ¬¡å¤§å°

**GPU è¨˜æ†¶é«”ä¸è¶³**ï¼š
- é™ä½æ‰¹æ¬¡å¤§å°
- å•Ÿç”¨æ¢¯åº¦ç´¯ç©
- ä½¿ç”¨æ··åˆç²¾åº¦è¨“ç·´

## æˆæ¬Š

MIT License - è©³è¦‹ [LICENSE](LICENSE) æª”æ¡ˆ

## è¯çµ¡æ–¹å¼

**åœ‹ç«‹é«˜é›„ç§‘æŠ€å¤§å­¸é›»è…¦èˆ‡é€šè¨Šå·¥ç¨‹ç³»**   
**å­¸ç”Ÿ**ï¼šææ³“æ–Œ  
**å­¸è™Ÿ**ï¼šC111110141  
**Email**ï¼š[c111110141@nkust.edu.tw](mailto:c111110141@nkust.edu.tw)  
å¦‚æœ‰å•é¡Œæˆ–å»ºè­°ï¼Œè«‹åœ¨ GitHub ä¸Šé–‹å•Ÿ issueã€‚
